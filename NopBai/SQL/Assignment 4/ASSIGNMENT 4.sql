DROP DATABASE IF EXISTS BT4;
CREATE DATABASE IF NOT EXISTS BT4;
USE BT4;

DROP TABLE IF EXISTS DEPARTMENT;
CREATE TABLE IF NOT EXISTS DEPARTMENT
(
 DEPARTMENT_NUMBER 	TINYINT PRIMARY KEY,
 DEPARTMENT_NAME    VARCHAR(30)
);
INSERT INTO DEPARTMENT (DEPARTMENT_NUMBER, DEPARTMENT_NAME)
VALUES
	(1,		'PHONG HOP'			),
	(2,		'PHONG MARKETING'	),
	(3,		'PHONG AN'			),
	(4,		'PHONG KE TOAN'		),
	(5,		'PHONG VE SINH'		),
	(6,		'PHONG NHAN SU'		),
	(7,		'PHONG TRUYEN THONG'),
	(8,		'PHONG NHAN SU'		),
	(9,		'PHONG GIAM DOC'	),
	(10,	'PHONG PHAT TRIEN'	);


DROP TABLE IF EXISTS EMPLOYEE_TABLE;
CREATE TABLE IF NOT EXISTS EMPLOYEE_TABLE
(
 EMPLOYEE_NUMBER  TINYINT PRIMARY KEY,
 EMPLOYEE_NAME	  VARCHAR(30),
 DEPARTMENT_NUMBER 	TINYINT
);
ALTER TABLE EMPLOYEE_TABLE
ADD FOREIGN KEY (DEPARTMENT_NUMBER) REFERENCES DEPARTMENT(DEPARTMENT_NUMBER);
INSERT INTO EMPLOYEE_TABLE (EMPLOYEE_NUMBER, EMPLOYEE_NAME, DEPARTMENT_NUMBER)
VALUES
	(1,		'NGUYEN VIET ANH',	  	 1 	),
	(2,		'NGUYEN HOANG THINH',	 1	),
	(3,		'NGUYEN  VIET KIEN',	 1	),
	(4,		'NGUYEN ANH TUAN',	 	 1	),
	(5,		'LE VAN THANH',	 	 	 3	),
	(6,		'PHAM MANH CUONG', 	 	 3	),
	(7,		'NGUYEN MANH CUONG', 	 3	),
	(8,		'PHAM TIEN DAT',		 3	),
	(9,		'CAO THU THAO',			 6	),
	(10,	'NGUYEN VAN HOANG',		 7	);
    
    
DROP TABLE IF EXISTS EMPLOYEE_SKILL_TABLE;
CREATE TABLE IF NOT EXISTS EMPLOYEE_SKILL_TABLE
(
 SKILL_CODE 		VARCHAR(30),
 DATE_REGISTERED 	DATE,
 EMPLOYEE_NUMBER    TINYINT
);
ALTER TABLE EMPLOYEE_SKILL_TABLE
ADD FOREIGN KEY (EMPLOYEE_NUMBER) REFERENCES EMPLOYEE_TABLE(EMPLOYEE_NUMBER);
INSERT INTO EMPLOYEE_SKILL_TABLE (SKILL_CODE, DATE_REGISTERED, EMPLOYEE_NUMBER)
VALUES 
	('JAVA',		'2019-09-09',	1	),
	('PYTHON',		'2019-09-09',	1	),
 	('RUBY',		'2019-09-09',	2	),
 	('C SHARP',		'2019-09-09',	3	),
 	('C ++',		'2019-09-09',	3	),
 	('C',			'2019-09-09',	5	),
 	('PHP',			'2019-09-09',	7	),
 	('HTML',		'2019-09-09',	9	),
 	('PERL',		'2019-09-09',	9	),
 	('ASSEMBLY',	'2019-09-09',	10	);
    
SELECT  EMPLOYEE_NAME
FROM  	EMPLOYEE_TABLE
WHERE   (SELECT COUNT(EMPLOYEE_NUMBER)
			FROM EMPLOYEE_SKILL_TABLE
			WHERE EMPLOYEE_TABLE.EMPLOYEE_NUMBER = EMPLOYEE_SKILL_TABLE.EMPLOYEE_NUMBER ) > 1;
        
    
    
 
 

